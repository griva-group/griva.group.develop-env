# [GGDDEnv] Добавление нового проекта

## Добавление нового проекта

Все контейнеры, кроме http-сервера описываются в папке виртуального хоста. В
тестовом проекте `~sample.vhost` воссоздана базовая файловая структура. Можно
менять состав и настройки по желанию и необходимости. Ниже я опишу базовую
настройку PHP+MySQL.

Лучше скопировать папку тестового проекта, что бы избежать ошибок. Название
новой папки дается на основе домена нового хоста. После - заменить навзание
тестовго проекта `sample.vhost` на домен новго в файлу `docker-compose.yaml`

```yaml
services:
  php:
    container_name: php.%project_name%
      environment:
      - VHOST_NAME=%project_name%
  sql:
    container_name: php.%project_name%.sql
```

### Управление контейнерами

Управление контейнерами происходит с помощью следующих команд, которые должны
исполнятся в папке проекта (где находится `docker-compose.yaml` файл).

```bash
# Запуск виртуальнго хоста
docker-compose up -d
docker exec -ti ggenv.nginx nginx -s reload

# Остановка виртуального хоста
docker-compose up -d
docker exec -ti ggenv.nginx nginx -s reload

# Вход в интерактивную оболочку (например: php)
docker exec -ti php.%project_name$ /bin/bash
```

### Создание виртуального раздела

Он необходим только при работе на не-linux ОС, потому что основная природа
docker - linux, и с другими файловыми система, такими как NTFS, APFS он
работает через прослойку, что сказывается на производительности. В основном,
я рекомендую его использовать при локальной разработке для размещения файлов
БД.

Создать раздел можно следующей командой. Желательно, что бы в названии
содержался домен виртуального хоста, тип и версия сервера БД.

```bash
docker volume create sql56.sample.vhost
```

А для подключения в `docker-compose.yaml` необходимо указать примерно такие
строчки:

```yaml
services:
  # ...
  sql:
    # ...
    volumes:
      - sql56.sample.vhost:/var/lib/mysql:delegated
  # ...
volumes:
  sql56.sample.vhost:
    external: true
```
